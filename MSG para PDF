import os
import tkinter as tk
from tkinter import filedialog

root = tk.Tk()
root.withdraw()

print("Selecione a pasta: ")
local_doc = filedialog.askdirectory()
print(local_doc)
n = 0

os.chdir(local_doc)

lista_docs = os.listdir(local_doc)


def numero_docs():
    x = int(len(lista_docs))
    y = x * 6
    return y


os.system("msg2pdf -d " + local_doc)

for i in range(0, numero_docs()):
    print(n)

    os.chdir(local_doc)
    print(local_doc)
    print("TRABALHANDO EM: " + os.getcwd())
    selecionado = os.listdir(local_doc)[n]
    print("Documento selecionado: " + selecionado)
    pdf_pasta = local_doc + "/" + selecionado
    print("Pasta do documento: " + pdf_pasta)


    if selecionado.endswith('.msg'):
        print('Documento .MSG original.')
        print('')
        pass

    elif selecionado.endswith('.pdf'):
        print('Documento já presente no destino.')
        print('')
        pass

    else:

        os.chdir(pdf_pasta)
        print("TRABALHANDO EM: " + os.getcwd())
        documentos = str(os.listdir(pdf_pasta))
        print('documentos:' + documentos)
        documento = documentos.replace('[', '')
        documento = documento.replace(']', '')
        documento = documento.replace("'", '')
        documento = documento.replace("'", '')
        print('documento em pdf na pasta: ' + documento)

        if os.path.exists(local_doc + documento):
            print('Já estava presente: ' + local_doc + documento)
            print('')
            pass

        else:
            pdf_sel = pdf_pasta + '/' + documento
            print("Documento: " + pdf_sel)
            os.rename(pdf_sel, local_doc + '/' + documento)
            print("Documento movido para: " + local_doc)
            os.chdir(local_doc)
            os.rmdir(pdf_pasta)
            print("Pasta removida: " + selecionado)
            print('')

    n += 1

## IMPLEMENTAR Excluir pasta vazia /// Feito
## EFICIENCIA!
